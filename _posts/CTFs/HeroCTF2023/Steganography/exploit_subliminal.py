import cv2

# Read the video file
cap = cv2.VideoCapture('subliminal_hide.mp4')

# Define the codec and create VideoWriter object to save the output video
fourcc = cv2.VideoWriter_fourcc(*'XVID')
out = cv2.VideoWriter('output_video.avi', fourcc, 30.0, (640, 480))

# Initialize the coordinates of the first square
x, y = 0, 0
i = 0
# Loop through each frame of the video
while(cap.isOpened()):
    # Read a frame from the video
    ret, frame = cap.read()

    if ret==True:
        # Extract the 20x20 square at the current position
        square = frame[y:y+20, x:x+20]

        # Save the square to a file
        cv2.imwrite(f'squares/{i}.png', square)
        i += 1
        # Update the position coordinates
        x += 20
        if x >= frame.shape[1]:
            x = 0
            y += 20
            if y >= frame.shape[0]:
                break

        # Display the resulting frame
        cv2.imshow('frame',frame)
        if cv2.waitKey(1) & 0xFF == ord('q'):
            break

        # Write the frame to the output video
        out.write(frame)

    else:
        break

# Release everything if job is finished
cap.release()
out.release()
cv2.destroyAllWindows()
